{% extends 'base.html' %}
{% block body %}
<body>
<div class="container" id="perfilContainer">
    <div class="col d-flex flex-column mt-3">
        <div class="row">
            <div class="col-3">
                <div class="col d-flex flex-column  align-items-center bg-light perfil-caixa justify-content-center h-100">
                    <div class="d-flex mt-2">
                        <h5 id="profileName">{{profile.first_name}} {{profile.last_name}}</h5>
                    </div>
                    <div class="col d-flex flex-column justify-content-center align-items-center justify-content-center">
                        <div>
                            <img src="{{profile.photo}}" alt="mdo" class="rounded-circle profile-image" id="profileImage">
                        </div>
                        <div>
                            <form action="/uploadImage" method="POST" id="photoForm" enctype = "multipart/form-data">
                                <label class="label-input-file" for="uploadProfilePic">Alterar Foto de Perfil</label>
                                <input name="file" id = "uploadProfilePic" type = "file" accept="image/*" onchange="sendUploadImage()"/>
                            </form>

                        </div>
                        <div class="mt-2" id="profileRating"></div>
                    </div>
                </div>
            </div>

            <div class="col-9 d-flex flex-column bg-light perfil-caixa">
                <div class="mt-2 mb-1">
                    <h3>Dados Pessoais</h3>
                </div>
                <form action="/updateProfileData" method="POST" enctype = "multipart/form-data">
                    <div class="col d-flex flex-column justify-content-center">
                        <div class="row g-3">
                            <div class="col-6">
                                <label for="floatingEmail">Endereço de email</label>
                                <input value="{{email}}" name="email" type="email" class="form-control input-shadow form-ismat" id="floatingEmail" placeholder="Email">
                            </div>
                            <div class="col-6">
                                <label for="floatingPhoneNumber">Telemóvel</label>
                                <input value="{{profile.phone_number}}" name="phone" type="text" class="form-control input-shadow form-ismat" id="floatingPhoneNumber" placeholder="Telemóvel">
                            </div>
                            <div class="col-6">
                                <label for="floatingFirstName">Nome</label>
                                <input value="{{profile.first_name}}" name="firstname" type="text" class="form-control input-shadow form-ismat" id="floatingFirstName" placeholder="Nome">
                            </div>
                            <div class="col-6">
                                <label for="floatinglastName">Apelido</label>
                                <input value="{{profile.last_name}}" name="lastname" type="text" class="form-control input-shadow form-ismat" id="floatinglastName" placeholder="Apelido">
                            </div>
                        </div>
                    </div>
                    <div class="col-3 mt-4 mb-3">
                        <button type="submit" class="btn-ismat-large">Guardar</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="row">
            <div class="modal fade" id="criarVeiculo" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="criarVeiculoLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="criarVeiculoLabel">Criar Veículo</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-bs-toggle="modal" data-bs-target="#editarVeiculos"></button>
                        </div>
                        <div class="modal-body">
                            <form class="row g-3" action="/createVehicle" method="POST">
                                <div class="col-md-6">
                                    <label for="inputMarca" class="form-label">Marca</label>
                                    <input type="text" name="brand" class="form-control input-shadow form-ismat" placeholder="Marca" id="inputMarca">
                                </div>
                                <div class="col-md-6">
                                    <label for="inputModelo" class="form-label">Modelo</label>
                                    <input type="text" name="model" class="form-control input-shadow form-ismat" placeholder="Modelo" id="inputModelo">
                                </div>
                                <div class="col-md-6">
                                    <label for="inputCor" class="form-label">Cor</label>
                                    <input type="text" name="color" class="form-control input-shadow form-ismat" placeholder="Origem" id="inputCor">
                                </div>
                                <div class="col-md-6">
                                    <label for="inputMatricula" class="form-label">Matrícula</label>
                                    <input type="text" name="licensePlate" class="form-control input-shadow form-ismat" placeholder="Destino" id="inputMatricula">
                                </div>
                                <div class="col-12 d-grid">
                                    <button type="submit" class="btn-ismat-large" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#editarVeiculos">Criar</button>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="editarVeiculos" data-bs-keyboard="false" tabindex="-1" aria-labelledby="editarVeiculosLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editarVeiculosLabel">Perfil</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="col">
                                <div class="h-100" id="carManagerWrapper">
                                    {% for car in vehicles%}
                                    <div class="d-flex align-items-start perfil-caixa bg-light mb-2">
                                        <img class="ms-4 d-none d-md-block me-4 align-self-center" src="../static/images/car-placeholder.png" alt="Car" style="height: 100px">
                                        <div>
                                            <div>
                                                <div class="">Matrícula: {{car.license_plate}}</div>
                                                <div class="">Marca: {{car.brand}}</div>
                                                <div class="">Modelo: {{car.model}}</div>
                                                <div class="">Cor: {{car.color}}</div>
                                            </div>
                                        </div>
                                        <div class="d-flex col flex-column">
                                            <button type="button" class="btn-close align-self-end me-2 mt-1" aria-label="Delete"></button>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="d-flex col mt-4">
                                <div class="col">
                                    <button type="button" class="btn-ismat-large" data-bs-toggle="modal" data-bs-dismiss="modal" data-bs-target="#criarVeiculo">Criar veículo</button>
                                </div>
                                <div class="d-flex col flex-column">
                                    <button type="button" class="btn-ismat-large align-self-end">Guardar Alterações</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-3 mt-3">
                <div class="col d-flex flex-column gap-3 align-items-center bg-light perfil-caixa justify-content-center h-100">
                    <img src="../static/images/car-placeholder.png" alt="Car" style="height: 100px">
                    <h5>Edite os seus veículos:</h5>
                    <button type="button" class="btn-ismat-large" data-bs-toggle="modal" data-bs-target="#editarVeiculos">Gerir Veículos</button>
                </div>
            </div>
            <div class="col-9 d-flex flex-column bg-light mt-3 perfil-caixa" style="height: 269px">
                <div class="mt-2 mb-1">
                    <h3>Alterar Password</h3>
                </div>
                <form action="/updatePassword" method="POST">
                    <div class="col d-flex flex-column justify-content-center">
                        <div class="row g-3">
                            <div class="col-6">
                                <label for="floatingActualPassword">Password Atual</label>
                                <input type="password" name="password" class="form-control input-shadow form-ismat" id="floatingActualPassword" placeholder="Password Atual">
                            </div>
                            <div class="col-6">
                                <label for="floatingPassword">Nova Password</label>
                                <input type="password" name="newPassword" class="form-control input-shadow form-ismat" id="floatingPassword" placeholder="Nova Password">
                            </div>
                            <div class="col-6">
                                <label for="floatingConfirmPassword">Confirmar Nova Password</label>
                                <input type="password" name="passwordConfirmation" class="form-control input-shadow form-ismat" id="floatingConfirmPassword" placeholder="Confirmar Nova Password">
                            </div>
                        </div>
                    </div>
                    <div class="col-3 mt-4 mb-3">
                        <button type="submit" class="btn-ismat-large">Guardar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% set classification = profile.classification %}

<script src="../static/js/script.js"></script>
<script>
    function sendUploadImage() {
        document.getElementById("photoForm").submit();
    }

    let data = [
        {
            user_id: "1",
            email: "a@a.com",
            firstName: "Maria",
            lastName: "João",
            photo: "./images/profilePictures/b.jpeg",
            phoneNumber: "123456789",
            rating: "4.7"
        }
    ]

    let vehicles = [
        {
            marca: "Peugeot",
            modelo: "106",
            cor: "Branco",
            matricula: "AL-52-98"
        },
        {
            marca: "Audi",
            modelo: "R8",
            cor: "Vermelho",
            matricula: "83-OK-39"
        },
        {
            marca: "Renault",
            modelo: "Clio",
            cor: "Preto",
            matricula: "03-72-KR"
        }
    ];
    let classification = "{{ profile.classification }}"
    starRatingGenerator(document.getElementById("profileRating"), classification)
</script>


</body>